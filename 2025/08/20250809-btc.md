---
layout: post
title: "btc: 署名サイズって"
tags:
  - bitcoin
date: "2025/08/09"
---

[Miniscript](https://blog.hirokuma.work/bitcoin/01_basics/miniscript.html)のページを書いている。  
日記に書いていたときは真面目に調べていなかったんだなあと反省して、細々と確認している。

Miniscript のツール全般なのかどうか分からないが統計データを出力してくれる。  
気にしているのは "Script" と "Input" である。

![image](https://blog.hirokuma.work/bitcoin/01_basics/images/miniscript1.png)

"Script" はそのまま数えれば良いのだが、署名は P2WSH まではサイズが変わるので面倒だ。

* [署名](https://blog.hirokuma.work/bitcoin/01_basics/transactions.html#%E7%BD%B2%E5%90%8D)

P2WSH では witness のスタックに載せるので、署名長+署名という計算方法になる。
シュノア署名であれば `SIGHASH_DEFAULT` であれば署名タイプも不要で、`R` も `S` もサイズが固定になるので 1+32+32 だ。

witness stack は先頭にスタックに載せるサイズがいるので `1+` と書いているのだが他ではどう表現しているのだろうね。
