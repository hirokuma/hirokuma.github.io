---
layout: post
title: "linux: libtoolの警告"
tags:
  - linux
  - clang
date: "2025/08/30"
---

[自分のメモ libsecp256k1](https://blog.hirokuma.work/bitcoin/library/clang.html#libsecp256k1) を見ながら Raspberry Pi3 でビルドをしている。  
いつもは `/usr/local` にインストールしていたのだが、`pkgconfig` でパスを指定する方法も覚えてきたので `$HOME/.local` にインストールすることにした。

```shell
$ ./configure --prefix $HOME/.local --enable-module-recovery
$ make
$ make install
......
libtool: warning: remember to run 'libtool --finish /usr/local/lib'
.......
```

今までこんな警告は出てきてたっけ？  
それにパスが `$HOME/.local/lib` ではないのも気になった。  
確認しよう。

## libtool

なんだかものすごく重たいというか開くまでに時間がかかったが、こちらが Libtool のページ。  
中の遷移も時間がかかるので見てないけど。

* [Libtool - GNU Project - Free Software Foundation](https://www.gnu.org/software/libtool/)

インストールするという感じではなく、カレントディレクトリにファイルとして存在していた。  
`Makefile` に `libtool.m4` というのがあったので automake 関係で作られたとかだろう。

```bash
/bin/bash ./libtool   --mode=install /usr/bin/install -c   libsecp256k1.la '/home/xxx/.local/lib'
```

[finish](https://manpages.ubuntu.com/manpages/bionic/ja/man1/libtool.1.html) は操作するモードのことらしい。  
2つ機能があり、1つは libtool ライブラリをインストールしてユーザが簡単に参照したりリンクできるようにする機能、
もう1つはクロスコンパイルされた libtool ライブラリをネイティブ環境に移植する際の作業を簡単にする機能だそうだ([gnu](https://www.gnu.org/software/libtool/manual/html_node/Finish-mode.html))。  
`.la` とからしいが、そもそもそういうのがよくわからんな。

詳しくは、こちら。

* [Autotools三兄弟の末っ子Libtoolとは何者なのか - Technology - KLablog - KLab株式会社](https://www.klab.com/jp/blog/tech/2015/1047107113.html)

「謎の拡張子 .laの正体」が役に立った。  
libsecp256k1 を `ls` で見るとこうなっていて、`.la` もある。  
中身はテキストファイルで、`dlname='libsecp256k1.so.6'` や `old_library='libsecp256k1.a'` などがある。  
static ライブラリ好きとしては "old" 扱いなのは悲しいが、指定しなかったら共有ライブラリが使われるくらいだし仕方ない。

```
libsecp256k1.a
libsecp256k1.la
libsecp256k1.so -> libsecp256k1.so.6.0.0
libsecp256k1.so.6 -> libsecp256k1.so.6.0.0
libsecp256k1.so.6.0.0
```

----

では、この警告は一体なんなんだ？という疑問だが、単に「思ってたのと違う」というだけっぽい。

* [\[SOLVED\] "libtool: warning: remember to run 'libtool --finish /usr/lib64'" while compiling .SlackBuilds.](https://www.linuxquestions.org/questions/slackware-14/libtool-warning-remember-to-run-%27libtool-finish-usr-lib64%27-while-compiling-slackbuilds-4175593774/)

libtool が automake とセットでよく使われるとなると、デフォルトで `/usr/local` を使うのに違うなんて、きー!、とか思ってしまうのかもしれない。
