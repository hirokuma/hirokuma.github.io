---
layout: post
title: "proto: Buf CLI(かきかけ)"
tags:
  - other
date: "2025/07/15"
draft: true
---

## はじめに

gRPC のプロジェクトがあり、"buf" というディレクトリがあった。  
そういえば昔使ったことがあるけど忘れてしまった、というわけで記事にしている。

proto ファイルのちょっとした履歴管理と lint に使っていたような気がする。

* [The Buf CLI - Buf](https://buf.build/product/cli)
  * [Introduction - Buf Docs](https://buf.build/docs/cli/)
  * [Releases · bufbuild/buf](https://github.com/bufbuild/buf/releases)

## インストール

これを書いている時点(2025/07/15)では v1.55.1 が最新だった。  
インストール方法はいろいろあるが、私は GitHub の Releaseページから`buf-Linux-x86_64`バイナリをダウンロードした。
assets がたくさんあって折りたたまれているファイルもあるので、開くとよいです。

```console
$ buf --version
1.55.1
```

私の環境に 2年くらい前インストールしていたのが v1.28 だったので、まあまあバージョンが上がりやすいツールなのだろう。

## 始めてみよう

この Quickstart は 2025/07/15時点で Buf CLI v1.32.0 以上となっている。

* [Quickstart - Buf Docs](https://buf.build/docs/cli/quickstart/)

書いてあるとおりにやれば良いのだが、最初に git clone する URL が SSH になっているので、
どうせ書き換えても pull request などするわけでもないから HTTPS でよいだろう。

```
$ git clone https://github.com/bufbuild/buf-examples.git && cd buf-examples/cli/quickstart/start/
```

![image](images/20250715a-1.png)

## protoc-go-gen

proto2 や proto3 があったが、その次の edition 2023 までは「Open Struct API」、さらに次の edition 2024+ から「Opaque API」になったそうだ。

* [API level](https://protobuf.dev/reference/go/go-generated/#apilevel)
  * [Go Generated Code Guide (Open) - Protocol Buffers Documentation](https://protobuf.dev/reference/go/go-generated/)
    * the old generated code API
  * [Go Generated Code Guide (Opaque) - Protocol Buffers Documentation](https://protobuf.dev/reference/go/go-generated-opaque/)
    * the current version

インストールするものが変わるわけではないようだ。

```console
$ go install google.golang.org/protobuf/cmd/protoc-gen-go@latest
```

## おわりに


