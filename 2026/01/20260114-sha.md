---
layout: post
title: "SHA256SUMS.asc"
tags:
  - other
  - bitcoin
date: "2026/01/14"
---

Bitcoin Core v30.2 がリリースされていたので更新しようとしたのだが、`sha256sum` の使い方を忘れた。

* [Index of /bin/bitcoin-core-30.2/](https://bitcoincore.org/bin/bitcoin-core-30.2/)

## 使い方

* [HowToSHA256SUM - Community Help Wiki](https://help.ubuntu.com/community/HowToSHA256SUM)

```shell
$ wget https://bitcoincore.org/bin/bitcoin-core-30.2/bitcoin-30.2-x86_64-linux-gnu.tar.gz
$ wget https://bitcoincore.org/bin/bitcoin-core-30.2/SHA256SUMS
$ sha256sum -c SHA256SUMS --ignore-missing
bitcoin-30.2-x86_64-linux-gnu.tar.gz: OK
```

## それぞれ

### sha256sum

```shell
$ sha256sum --help
Usage: sha256sum [OPTION]... [FILE]...
Print or check SHA256 (256-bit) checksums.

With no FILE, or when FILE is -, read standard input.
  -b, --binary          read in binary mode
  -c, --check           read checksums from the FILEs and check them
      --tag             create a BSD-style checksum
  -t, --text            read in text mode (default)
  -z, --zero            end each output line with NUL, not newline,
                          and disable file name escaping

The following five options are useful only when verifying checksums:
      --ignore-missing  don't fail or report status for missing files
      --quiet           don't print OK for each successfully verified file
      --status          don't output anything, status code shows success
      --strict          exit non-zero for improperly formatted checksum lines
  -w, --warn            warn about improperly formatted checksum lines

      --help        display this help and exit
      --version     output version information and exit

The sums are computed as described in FIPS-180-2.
When checking, the input should be a former output of this program.
The default mode is to print a line with: checksum, a space,
a character indicating input mode ('*' for binary, ' ' for text
or where binary is insignificant), and name for each FILE.

Note: There is no difference between binary mode and text mode on GNU systems.

GNU coreutils online help: <https://www.gnu.org/software/coreutils/>
Report any translation bugs to <https://translationproject.org/team/>
Full documentation <https://www.gnu.org/software/coreutils/sha256sum>
or available locally via: info '(coreutils) sha2 utilities'
```

wget で取得

```shell
$ wget https://bitcoincore.org/bin/bitcoin-core-30.2/bitcoin-30.2-x86_64-linux-gnu.tar.gz
$ wget https://bitcoincore.org/bin/bitcoin-core-30.2/SHA256SUMS
```

#### --ignore-missing なし

```shell
$ sha256sum -c SHA256SUMS
sha256sum: bitcoin-30.2-aarch64-linux-gnu-debug.tar.gz: No such file or directory
bitcoin-30.2-aarch64-linux-gnu-debug.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-aarch64-linux-gnu.tar.gz: No such file or directory
bitcoin-30.2-aarch64-linux-gnu.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-arm-linux-gnueabihf-debug.tar.gz: No such file or directory
bitcoin-30.2-arm-linux-gnueabihf-debug.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-arm-linux-gnueabihf.tar.gz: No such file or directory
bitcoin-30.2-arm-linux-gnueabihf.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-arm64-apple-darwin.tar.gz: No such file or directory
bitcoin-30.2-arm64-apple-darwin.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-arm64-apple-darwin.zip: No such file or directory
bitcoin-30.2-arm64-apple-darwin.zip: FAILED open or read
sha256sum: bitcoin-30.2-arm64-apple-darwin-codesigning.tar.gz: No such file or directory
bitcoin-30.2-arm64-apple-darwin-codesigning.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-arm64-apple-darwin-unsigned.tar.gz: No such file or directory
bitcoin-30.2-arm64-apple-darwin-unsigned.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-arm64-apple-darwin-unsigned.zip: No such file or directory
bitcoin-30.2-arm64-apple-darwin-unsigned.zip: FAILED open or read
sha256sum: bitcoin-30.2-codesignatures-30.2.tar.gz: No such file or directory
bitcoin-30.2-codesignatures-30.2.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2.tar.gz: No such file or directory
bitcoin-30.2.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-powerpc64-linux-gnu-debug.tar.gz: No such file or directory
bitcoin-30.2-powerpc64-linux-gnu-debug.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-powerpc64-linux-gnu.tar.gz: No such file or directory
bitcoin-30.2-powerpc64-linux-gnu.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-riscv64-linux-gnu-debug.tar.gz: No such file or directory
bitcoin-30.2-riscv64-linux-gnu-debug.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-riscv64-linux-gnu.tar.gz: No such file or directory
bitcoin-30.2-riscv64-linux-gnu.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-x86_64-apple-darwin.tar.gz: No such file or directory
bitcoin-30.2-x86_64-apple-darwin.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-x86_64-apple-darwin.zip: No such file or directory
bitcoin-30.2-x86_64-apple-darwin.zip: FAILED open or read
sha256sum: bitcoin-30.2-x86_64-apple-darwin-codesigning.tar.gz: No such file or directory
bitcoin-30.2-x86_64-apple-darwin-codesigning.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-x86_64-apple-darwin-unsigned.tar.gz: No such file or directory
bitcoin-30.2-x86_64-apple-darwin-unsigned.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-x86_64-apple-darwin-unsigned.zip: No such file or directory
bitcoin-30.2-x86_64-apple-darwin-unsigned.zip: FAILED open or read
sha256sum: bitcoin-30.2-x86_64-linux-gnu-debug.tar.gz: No such file or directory
bitcoin-30.2-x86_64-linux-gnu-debug.tar.gz: FAILED open or read
bitcoin-30.2-x86_64-linux-gnu.tar.gz: OK
sha256sum: bitcoin-30.2-win64-setup.exe: No such file or directory
bitcoin-30.2-win64-setup.exe: FAILED open or read
sha256sum: bitcoin-30.2-win64.zip: No such file or directory
bitcoin-30.2-win64.zip: FAILED open or read
sha256sum: bitcoin-30.2-win64-codesigning.tar.gz: No such file or directory
bitcoin-30.2-win64-codesigning.tar.gz: FAILED open or read
sha256sum: bitcoin-30.2-win64-debug.zip: No such file or directory
bitcoin-30.2-win64-debug.zip: FAILED open or read
sha256sum: bitcoin-30.2-win64-setup-unsigned.exe: No such file or directory
bitcoin-30.2-win64-setup-unsigned.exe: FAILED open or read
sha256sum: bitcoin-30.2-win64-unsigned.zip: No such file or directory
bitcoin-30.2-win64-unsigned.zip: FAILED open or read
sha256sum: WARNING: 27 listed files could not be read
```

#### --ignore-missing あり

```shell
$ sha256sum -c SHA256SUMS --ignore-missing
bitcoin-30.2-x86_64-linux-gnu.tar.gz: OK
```

## SHA256SUMS.asc の使われ方

Bitcoin Core v22 から複数の公開鍵で署名するようになったそうだ。  
チェックしてダウンロードするためのスクリプトも提供してある。

* [bitcoin/contrib/verify-binaries/README.md at 30.x · bitcoin/bitcoin](https://github.com/bitcoin/bitcoin/blob/30.x/contrib/verify-binaries/README.md)

`verify.py` だけをディレクトリに置いている。

手順として、署名者の誰か(複数で良い)を信用する必要がある。
信用＝チェックする鍵としてインポートしておく、という意味になる。

まずは何もインポートしていない状態でやってみると "got 0 good signatures" ということでエラーになった(`/tmp` にディレクトリを作ってダウンロードするようだ)。  
WARNING は bitcoin.org からダウンロードできないという内容だ。
現在 [bitcoin.org/en/download](https://bitcoin.org/en/download) には v28.1 しかないようだった。

```shell
$ ./verify.py pub 30.2
[INFO] got file https://bitcoincore.org/bin/bitcoin-core-30.2/SHA256SUMS.asc as SHA256SUMS.asc
[WARNING] https://bitcoin.org failed to provide file (https://bitcoin.org/bin/bitcoin-core-30.2/SHA256SUMS.asc). Continuing based solely upon https://bitcoincore.org.
[INFO] got file https://bitcoincore.org/bin/bitcoin-core-30.2/SHA256SUMS as SHA256SUMS
[WARNING] https://bitcoin.org failed to provide file (https://bitcoin.org/bin/bitcoin-core-30.2/SHA256SUMS). Continuing based solely upon https://bitcoincore.org.
[INFO] got 0 good signatures
[INFO] Maybe you need to import (`gpg --keyserver hkps://keys.openpgp.org --recv-keys <key-id>`) some of the following keys:
[INFO]
[INFO]     E2FFD5B1D88CA97D ()
[INFO]     17565732E08E5E41 (me@achow101.com)
[INFO]     3152347D07DA627C ()
[INFO]     2EEB9F5CC09526C1 (fanquake@gmail.com)
[INFO]     8E4256593F177720 (gugger@gmail.com)
[INFO]     410108112E7EA81F (hebasto@gmail.com)
[INFO]     E7E2984B6289C93A (pinheadmz@gmail.com)
[INFO]     57FF9BDBCC301009 ()
[INFO]
[ERROR] not enough trusted sigs to meet threshold (0 vs. 3)
```

個人的な知り合いなどいないので、誰を信用したものか。。。  
とりあえず一番上にある鍵で検索してみると "bxB10C <b10c@b10c.me>" さん。  
[ビルダー鍵リスト](https://github.com/bitcoin-core/guix.sigs/tree/6490653f3135584f13db6df113318371f9876633/builder-keys) にも3年前に登録されている。

* [Search results for '0xE2FFD5B1D88CA97D'](https://keyserver.ubuntu.com/pks/lookup?search=E2FFD5B1D88CA97D&fingerprint=on&op=index)

正直なところ、どうやって信用してよいのかわからない。。  
リポジトリに登録してあるので、そこは複数人がチェックして承認したはずだからリスト自体は信用したい。  
しかしダウンロードしてきたファイルにある署名の人がその人かどうかを信用してはいけないだろう。  

[30.2/0xb10c/all.SHA256SUMS.asc](https://github.com/bitcoin-core/guix.sigs/blob/6490653f3135584f13db6df113318371f9876633/30.2/0xb10c/all.SHA256SUMS.asc) と
ダウンロードした `SHA256SUMS.asc` の中の1つが一致したから、少なくともこの人はバイナリに署名した一人とみなしてよいだろうと勝手に思うことにした。

```shell
$ gpg --keyserver hkps://keys.openpgp.org --recv-keys E2FFD5B1D88CA97D
gpg: key 188CBB2648416AD5: public key ".0xB10C <b10c@b10c.me>" imported
gpg: Total number processed: 1
gpg:               imported: 1
```

一人だけインポートしてから実行すると、ちゃんと 1つ成功になった。

```shell
$ ./verify.py pub 30.2
[INFO] got file https://bitcoincore.org/bin/bitcoin-core-30.2/SHA256SUMS.asc as SHA256SUMS.asc
[WARNING] https://bitcoin.org failed to provide file (https://bitcoin.org/bin/bitcoin-core-30.2/SHA256SUMS.asc). Continuing based solely upon https://bitcoincore.org.
[INFO] got file https://bitcoincore.org/bin/bitcoin-core-30.2/SHA256SUMS as SHA256SUMS
[WARNING] https://bitcoin.org failed to provide file (https://bitcoin.org/bin/bitcoin-core-30.2/SHA256SUMS). Continuing based solely upon https://bitcoincore.org.
[INFO] got 1 good signatures
[INFO] Maybe you need to import (`gpg --keyserver hkps://keys.openpgp.org --recv-keys <key-id>`) some of the following keys:
[INFO]
[INFO]     17565732E08E5E41 (me@achow101.com)
[INFO]     3152347D07DA627C ()
[INFO]     2EEB9F5CC09526C1 (fanquake@gmail.com)
[INFO]     8E4256593F177720 (gugger@gmail.com)
[INFO]     410108112E7EA81F (hebasto@gmail.com)
[INFO]     E7E2984B6289C93A (pinheadmz@gmail.com)
[INFO]     57FF9BDBCC301009 ()
[INFO]
[ERROR] not enough trusted sigs to meet threshold (1 vs. 3)
```

`verify.py --import-keys` を指定すると持っていない鍵はインポートするか確認してくれるそうだ。
楽ではあるが、それはそれで大丈夫なのだろうか？  

ひとまず 3つ鍵をインポートして実行した。  
バージョン指定だけだと全部ダウンロードしそうなので `x86_64-linux` も指定した。  
実行すると `/tmp/bitcoin_verify_binaries.30.2-x86_64-linux/bitcoin-30.2-x86_64-linux-gnu.tar.gz` がダウンロードされていた。  
`verify.py` だからダウンロードしたファイルの verify なのかと思っていたが、ダウンローダなのだな。

```shell
$ ./verify.py pub 30.2-x86_64-linux
[INFO] got file https://bitcoincore.org/bin/bitcoin-core-30.2/SHA256SUMS.asc as SHA256SUMS.asc
[WARNING] https://bitcoin.org failed to provide file (https://bitcoin.org/bin/bitcoin-core-30.2/SHA256SUMS.asc). Continuing based solely upon https://bitcoincore.org.
[INFO] got file https://bitcoincore.org/bin/bitcoin-core-30.2/SHA256SUMS as SHA256SUMS
[WARNING] https://bitcoin.org failed to provide file (https://bitcoin.org/bin/bitcoin-core-30.2/SHA256SUMS). Continuing based solely upon https://bitcoincore.org.
[INFO] got 3 good signatures
[INFO] GOOD SIGNATURE (untrusted): SigData('E2FFD5B1D88CA97D', '.0xB10C <b10c@b10c.me>', trusted=False, status='')
[INFO] GOOD SIGNATURE (untrusted): SigData(略)
[INFO] GOOD SIGNATURE (untrusted): SigData(略)
[WARNING] UNKNOWN SIGNATURE: SigData(略)
[WARNING] UNKNOWN SIGNATURE: SigData(略)
[WARNING] UNKNOWN SIGNATURE: SigData(略)
[WARNING] UNKNOWN SIGNATURE: SigData(略)
[WARNING] UNKNOWN SIGNATURE: SigData(略)
[INFO] removing *-debug binaries (bitcoin-30.2-x86_64-linux-gnu-debug.tar.gz) from verification since https://bitcoincore.org does not host *-debug binaries
[INFO] downloading bitcoin-30.2-x86_64-linux-gnu.tar.gz to /tmp/bitcoin_verify_binaries.30.2-x86_64-linux
[INFO] did not clean up /tmp/bitcoin_verify_binaries.30.2-x86_64-linux
VERIFIED: bitcoin-30.2-x86_64-linux-gnu.tar.gz
```
